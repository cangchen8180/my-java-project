## OLAP介绍和方案对比
OLAP（Online Analytical Processing），联机分析处理（OLAP）系统是数据仓库系统最主要的应用，专门设计用于支持复杂的分析操作，侧重对决策人员和高层管理人员的决策支持，可以根据分析人员的要求快速、灵活地进行大数据量的复杂查询处理，并且以一种直观而易懂的形式将查询结果提供给决策人员，以便他们准确掌握企业（公司）的经营状况，了解对象的需求，制定正确的方案。

OLAP解决方案可以分为4种，它们各有各的优势：

- SQL on HBase方案

    例如：Phoenix、Kylin。我们团队从2015年Q1开始，陆续在SEM、SEO生产环境中使用Phoenix、Kylin至今。Phoenix算是一个“全能选手”，但更适合业务模式较固定的场景；Kylin是一个很不错的OLAP产品，但它的问题是不能很好支持实时查询和明细查询，因为它需要离线预聚合。另外，基于其他NoSQL的方案，基本大同小异，如果选择HBase，建议团队在HBase运维方面有一定积累。

- SQL on HDFS方案

    例如：Presto、Spark SQL。这两个产品，因为只能做到亚秒级查询，我们平时多用在数据挖掘的场景中。

- 时序数据库方案

    例如：Druid、OpenTSDB。OpenTSDB是我们旧版App异常监控系统使用过的方案，更适合做系统指标监控。

- 搜索引擎方案

    代表项目有ES。相对上面的3种方案，基于倒排索引的ES非常适合异常分析的场景，可以满足：实时、秒级、明细、聚合，全部4种需求。

    注：ES的写入速度大概是每秒1万行。

    >如何解决ES写入慢的瓶颈？

    >答：使用服务降级方案。
    就是根据写ES的实际瓶颈K，对每个周期处理的全部数据N使用水塘抽样（比例K/N），保证始终不超过瓶颈。并在空闲时刻使用Spark批处理，将N-K部分从HDFS补写到ES。